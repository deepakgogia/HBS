SELECT * FROM VOTS_CONTRACT_EXTENSION_REQUEST where MISS_CODE='010272181'
ALTER TABLE VOTS_CONTRACT_EXTENSION_REQUEST Add IsProcessed tinyint
alter table VOTS_CONTRACT_EXTENSION_REQUEST drop column IsProcessed
sp_helptext uspEvoliaAddExtensionDate_19092018

begin tran
update VOTS_CONTRACT_EXTENSION_REQUEST set IsProcessed=0 where MISS_CODE='010272181'
commit tran
CREATE PROCEDURE [dbo].[uspEvoliaAddExtensionDate_19092018]       
 @MissCode VARCHAR(10),      
 @ConsulatantId VARCHAR(15),      
 @ConsulatantName VARCHAR(200),      
 @BackOffice VARCHAR(10),      
 @TempName VARCHAR(200),    
 @extension_date DATETIME,    
 @actionType INT,    
 @reason VARCHAR(500),    
 @comment VARCHAR(1000),
 @isprocessed tinyint
AS                        
BEGIN         
  
 DECLARE @CNTI_MATR VARCHAR(50)  
 SELECT @CNTI_MATR = MAX(CNTI_MATR) from WTCNTI WT INNER JOIN WTMISS MISS ON WT.PER_ID = MISS.PER_ID AND WT.CNT_ID = MISS.CNT_ID  
 AND WT.TIE_ID = MISS.TIE_ID WHERE MISS.MISS_CODE = @MissCode  
                 
 INSERT INTO VOTS_CONTRACT_EXTENSION_REQUEST     
 (MISS_CODE, REQUESTOR_ID, MANAGER_NAME, BO_VALUE, EXTENSION_DATE, WORKER_NAME, ACTION_TYPE, REASON, COMMENT, CREATED_DATE,CNTI_MATR,IsProcessed)     
 VALUES     
 (@MissCode, @ConsulatantId,@ConsulatantName,@BackOffice, @extension_date,@TempName,@actionType, @reason, @comment, GETDATE(),@CNTI_MATR,@isprocessed)    
    
END





------------------------------------------


exec uspEvoliaGetContractDetailsForExtension '','','','209733','','','2','17/09/2018','23/09/2018',''

exec uspEvoliaGetContractDetailsForExtension '','','','','','','2','','','010271911'
sp_helptext uspEvoliaGetContractDetailsForExtension_13092018

"'200747','203493','202813','200582','200752','200746','203111','200765','200739','200743','200708','201647','204232','200687','209746','200976','204223','212691','211678','212021','213372','208129','201712','206854','201364','211484','212018','201346','211658','206748','204238','200696','204228','212688','200721','200721','210400','200581','205851','200572','208264','200556','200496','200519','200759','212358','200735','200720','200660','204624','200571','211342','208780','210870','211961','212063','212925','201827','212078','201342','206670','208214','201090','212867','212681','212970','210697','213568','212817','210503','201678','210293','207442','212632','212288','213436','207943','205751','211771','212945','208862','211413','209696','213312','209433','210928','208006','211154','212678','213194','213637','213470','210415','205141','202485','206326','200509','213067','201780','211534','206583','213326','213117','207755','211355','211757','212424','212915','210081','212948','212282','205574','204186','208493','208861','211089','210582','212296','213588','213147','210174','204687','210362','212427','205446','210979','211638','205725','213488','207026','213143','211637','209920','213392','209592','209936','213442','213448','212081','209775','210651','213498','213645','213415','210548','211104','213305','209691','213501','213390','213423','210493','210852','212916','212844','212866','211958','211331','212941','210560','212289','207476','201500','201467','200500','213497','213499','200488','203425','213314','209190','211265','211261','209376','209463','212508','211254','211877','213052','213389','206059','201051','205338','213300','210004','212883','210053','213464','210358','212433','209655','207048','203600','210475','213068','213544','200493','208552','212501','212815','211285','201319','205695','209929','208062','212365','213116','213053','202866','206893','211655','212747','207966','211830','207471','203360','206029','203502','203361','212612','208809','213428','213419','211649','208808','212426','213181','201050','201034','200563','205402','200554','201935','200472','205841','200490','204963','213193','203877','213453','211521','208503','208508','210278','211948','212847','213146','208167','212889','210810','209575','212420','207528','212626','213142','206679','211284','208502','208063','200527','209584','210395','212877','212776','209671','205567','208694','207952','213080','212760','211778','212255','212366','200593','209117','213072','211849','213596','207935','212519','210489','212596','210403','211951','213408','203407','210378','213214','209387','213593','213176','209829','210173','206611','212002','211955','212499','211934','200483','208179','213368','210909','212264','212306','207089','206360','203663','206821','212057','210332','212260','211923','201933','210116','209403','203147','206771','212536','213013','213383','213269','205466','207396','210877','211426','212717','208317','209990','211919','211171','210731','213060','213358','209589','213271','211167','211056','200506','212287','212166','206763','203468','204910','208545','212345','208495','208311','209799','212502','213662','211990','212646','212713','201408','204227','208642','200879','212886','200663','210541','206467','204235','206210','203128','209689','212918','213635','210603','210740','205886','209591','206195','204260','206575','211893','204580','209581','206116','209688','211691','205924','206920','207547','204246','204243','204755','213467','209910','213179','211501','204233','212642','211897','207044','210145','204317','211500','212170','208256','204241','212938','205163','204240','207344','204244','213564','211350','207050','206035','212846','200719','212058','204247','201448','201763','200754','204334','211804','200607','200624','200612','200480','200864','200584','203807','212940','203294','209541','212434','208649','213313','207352','209630','213398','210287','209908','203409','204016','206021','208827','212019','213468','208302','208432','213203','212689','209828','213357','211551','210221','212842','203802','201140','204578','212528','213427','213120','208547','210536','212763','207823','211988','212524','212736','213489','213424','202738','200677','211782','208118','207223','201674','207183','212897','212899','209762','205130','213461','210017','208792','206231','211876','211490','210839','213144','210079','208030','207457','212971','211684','213048','210840','212959','203281','202310','207134','212004','210556','211103','212937','206919','212169','210037','200596','204389','207775','205633','211102','213353','212060','213330','211313','210171','211643','208273','207009','212585','208132','210308','212038','213548','212555','209960','212687','213630','202446','206187','204226','209355','204225','200685','201063','204230','207837','200698','201112','201752','211200','211563','209420','209425','204737','203666','211480','211346','209423','203621','207752','213175','210398','211535','211140','211537','209401','213586','211135','213582','213615','213204','203806','207758','211141','211366','201956','213178','212882','209386','209540','209418','210597','203756','213197','213198','209402','207756','211506','211482','211640','209391','213613','213070','213007','213074','209411','209395','211339','209315','211577','212957','213426','213614','211672','211508','210755','208469','201653','209419','211139','213073','213585','209424','211142','211505','212952','213174','203329','206589','200694','200678','201277','204248','211966','201284','209114','213445','209354','204237','200664','200674','204118','213177','200684','213161','205665','203236','212995','210466','206911','210328','207867','207045','200654','207291','207371','212984','210813','213646','207364','209470','204292','210589','210312','213664','204348','213534','204385','205870','210067','206950','211410','211622','204234','210311','210728','201934','203182','205724','204851','206915','206601','207843','208754','212275','209902','212470','207831','210363','208342','203296','213195','210893','209379','211235','211836','211989','212455','212870','212456','213393','213012','210137','213200','211663','212840','212862','212841','213570','212520','211774','213409','209877','207688','211821','211098','210638','212895','212927','213447','209585','204768','208556','200658','213567','200646','212142','200574','209090','213320','209733','209703','202773','210940','203842','203433','213130','206928',''"

declare @it varchar(max)
set @it='''200747'',''203493'',''202813'',''200582'',''200752'',''200746'',''203111'',''200765'',''200739'',''200743'',''200708'',''201647'',
''204232'',''200687'',''209746'',''200976'',''204223'',''212691'',''211678'',''212021'',''213372'',''208129'',''201712'',''206854'',''201364'',''211484'',''212018'',''201346'',''211658'',''206748'',
''204238'',''200696'',''204228'',''212688'',''200721'',''200721'',''210400'',''200581'',''205851'',''200572'',''208264'',''200556'',''200496'',''200519'',''200759'',''212358'',''200735'',''200720'',
''200660'',''204624'',''200571'',''211342'',''208780'',''210870'',''211961'',''212063'',''212925'',''201827'',''212078'',''201342'',''206670'',''208214'',''201090'',''212867'',''212681'',''212970'',
''210697'',''213568'',''212817'',''210503'',''201678'',''210293'',''207442'',''212632'',''212288'',''213436'',''207943'',''205751'',''211771'',''212945'',''208862'',''211413'',''209696'',''213312'',
''209433'',''210928'',''208006'',''211154'',''212678'',''213194'',''213637'',''213470'',''210415'',''205141'',''202485'',''206326'',''200509'',''213067'',''201780'',''211534'',''206583'',''213326'',
''213117'',''207755'',''211355'',''211757'',''212424'',''212915'',''210081'',''212948'',''212282'',''205574'',''204186'',''208493'',''208861'',''211089'',''210582'',''212296'',''213588'',''213147'',
''210174'',''204687'',''210362'',''212427'',''205446'',''210979'',''211638'',''205725'',''213488'',''207026'',''213143'',''211637'',''209920'',''213392'',''209592'',''209936'',''213442'',''213448'',
''212081'',''209775'',''210651'',''213498'',''213645'',''213415'',''210548'',''211104'',''213305'',''209691'',''213501'',''213390'',''213423'',''210493'',''210852'',''212916'',''212844'',''212866'',
''211958'',''211331'',''212941'',''210560'',''212289'',''207476'',''201500'',''201467'',''200500'',''213497'',''213499'',''200488'',''203425'',''213314'',''209190'',''211265'',''211261'',''209376'',
''209463'',''212508'',''211254'',''211877'',''213052'',''213389'',''206059'',''201051'',''205338'',''213300'',''210004'',''212883'',''210053'',''213464'',''210358'',''212433'',''209655'',''207048'',
''203600'',''210475'',''213068'',''213544'',''200493'',''208552'',''212501'',''212815'',''211285'',''201319'',''205695'',''209929'',''208062'',''212365'',''213116'',''213053'',''202866'',''206893'',
''211655'',''212747'',''207966'',''211830'',''207471'',''203360'',''206029'',''203502'',''203361'',''212612'',''208809'',''213428'',''213419'',''211649'',''208808'',''212426'',''213181'',''201050'',
''201034'',''200563'',''205402'',''200554'',''201935'',''200472'',''205841'',''200490'',''204963'',''213193'',''203877'',''213453'',''211521'',''208503'',''208508'',''210278'',''211948'',''212847'',
''213146'',''208167'',''212889'',''210810'',''209575'',''212420'',''207528'',''212626'',''213142'',''206679'',''211284'',''208502'',''208063'',''200527'',''209584'',''210395'',''212877'',''212776'',
''209671'',''205567'',''208694'',''207952'',''213080'',''212760'',''211778'',''212255'',''212366'',''200593'',''209117'',''213072'',''211849'',''213596'',''207935'',''212519'',''210489'',''212596'',
''210403'',''211951'',''213408'',''203407'',''210378'',''213214'',''209387'',''213593'',''213176'',''209829'',''210173'',''206611'',''212002'',''211955'',''212499'',''211934'',''200483'',''208179'',
''213368'',''210909'',''212264'',''212306'',''207089'',''206360'',''203663'',''206821'',''212057'',''210332'',''212260'',''211923'',''201933'',''210116'',''209403'',''203147'',''206771'',''212536'',
''213013'',''213383'',''213269'',''205466'',''207396'',''210877'',''211426'',''212717'',''208317'',''209990'',''211919'',''211171'',''210731'',''213060'',''213358'',''209589'',''213271'',''211167'',
''211056'',''200506'',''212287'',''212166'',''206763'',''203468'',''204910'',''208545'',''212345'',''208495'',''208311'',''209799'',''212502'',''213662'',''211990'',''212646'',''212713'',''201408'',
''204227'',''208642'',''200879'',''212886'',''200663'',''210541'',''206467'',''204235'',''206210'',''203128'',''209689'',''212918'',''213635'',''210603'',''210740'',''205886'',''209591'',''206195'',
''204260'',''206575'',''211893'',''204580'',''209581'',''206116'',''209688'',''211691'',''205924'',''206920'',''207547'',''204246'',''204243'',''204755'',''213467'',''209910'',''213179'',''211501'',
''204233'',''212642'',''211897'',''207044'',''210145'',''204317'',''211500'',''212170'',''208256'',''204241'',''212938'',''205163'',''204240'',''207344'',''204244'',''213564'',''211350'',''207050'',
''206035'',''212846'',''200719'',''212058'',''204247'',''201448'',''201763'',''200754'',''204334'',''211804'',''200607'',''200624'',''200612'',''200480'',''200864'',''200584'',''203807'',''212940'',
''203294'',''209541'',''212434'',''208649'',''213313'',''207352'',''209630'',''213398'',''210287'',''209908'',''203409'',''204016'',''206021'',''208827'',''212019'',''213468'',''208302'',''208432'',
''213203'',''212689'',''209828'',''213357'',''211551'',''210221'',''212842'',''203802'',''201140'',''204578'',''212528'',''213427'',''213120'',''208547'',''210536'',''212763'',''207823'',''211988'',
''212524'',''212736'',''213489'',''213424'',''202738'',''200677'',''211782'',''208118'',''207223'',''201674'',''207183'',''212897'',''212899'',''209762'',''205130'',''213461'',''210017'',''208792'',
''206231'',''211876'',''211490'',''210839'',''213144'',''210079'',''208030'',''207457'',''212971'',''211684'',''213048'',''210840'',''212959'',''203281'',''202310'',''207134'',''212004'',''210556'',
''211103'',''212937'',''206919'',''212169'',''210037'',''200596'',''204389'',''207775'',''205633'',''211102'',''213353'',''212060'',''213330'',''211313'',''210171'',''211643'',''208273'',''207009'',
''212585'',''208132'',''210308'',''212038'',''213548'',''212555'',''209960'',''212687'',''213630'',''202446'',''206187'',''204226'',''209355'',''204225'',''200685'',''201063'',''204230'',''207837'',
''200698'',''201112'',''201752'',''211200'',''211563'',''209420'',''209425'',''204737'',''203666'',''211480'',''211346'',''209423'',''203621'',''207752'',''213175'',''210398'',''211535'',''211140'',
''211537'',''209401'',''213586'',''211135'',''213582'',''213615'',''213204'',''203806'',''207758'',''211141'',''211366'',''201956'',''213178'',''212882'',''209386'',''209540'',''209418'',''210597'',
''203756'',''213197'',''213198'',''209402'',''207756'',''211506'',''211482'',''211640'',''209391'',''213613'',''213070'',''213007'',''213074'',''209411'',''209395'',''211339'',''209315'',''211577'',
''212957'',''213426'',''213614'',''211672'',''211508'',''210755'',''208469'',''201653'',''209419'',''211139'',''213073'',''213585'',''209424'',''211142'',''211505'',''212952'',''213174'',''203329'',
''206589'',''200694'',''200678'',''201277'',''204248'',''211966'',''201284'',''209114'',''213445'',''209354'',''204237'',''200664'',''200674'',''204118'',''213177'',''200684'',''213161'',''205665'',
''203236'',''212995'',''210466'',''206911'',''210328'',''207867'',''207045'',''200654'',''207291'',''207371'',''212984'',''210813'',''213646'',''207364'',''209470'',''204292'',''210589'',''210312'',
''213664'',''204348'',''213534'',''204385'',''205870'',''210067'',''206950'',''211410'',''211622'',''204234'',''210311'',''210728'',''201934'',''203182'',''205724'',''204851'',''206915'',''206601'',
''207843'',''208754'',''212275'',''209902'',''212470'',''207831'',''210363'',''208342'',''203296'',''213195'',''210893'',''209379'',''211235'',''211836'',''211989'',''212455'',''212870'',''212456'',
''213393'',''213012'',''210137'',''213200'',''211663'',''212840'',''212862'',''212841'',''213570'',''212520'',''211774'',''213409'',''209877'',''207688'',''211821'',''211098'',''210638'',''212895'',
''212927'',''213447'',''209585'',''204768'',''208556'',''200658'',''213567'',''200646'',''212142'',''200574'',''209090'',''213320'',''209733'',''209703'',
''202773'',''210940'',''203842'',''203433'',''213130'',''206928'','''
select @it
exec uspEvoliaGetContractDetailsForExtension_19092018 '','','','','','','2','17/09/2018','23/09/2018','','0'

exec uspEvoliaGetContractDetailsForExtension_19092018 '','','','','','','2','','','010272181',1   200746
exec uspEvoliaGetContractDetailsForExtension_19092018 '','','','200746,204334,200976,200754,204247,201763,201063,200607,200698,200664,200674,215658,215682,202446,204248,215441,207837,215527,215513,215542,215518,201752,201112,215535,215536,215516,215517,215428,215426,215523,215526,215683,215544,203806,201956,203756,209418,210597,213070,212882,209411,213197,211339,211640,207756,213007,213426,213614,213178,211577,209395,211141,204737,201653,203666,211508,215620,213732,209425,209423,211140,209401,207752,211537,213607,211535,213586,213585,208469,209419,209424,211142,211505,213073,213615,211563,211200,209420,200684,213177,213161,215140,205665,204118,203236,206911,210466,215217,214456,200654,207045,207291,212984,213409,215729,214038,215056,215118,212687,214641,215346,208132,215319,201934,210728,212275,210363,203296,206601,215314,215219,215201,213200,215623,214425,214899,215228,214791,214380,209877,215685,211821,214654,215653,215033,209902,211836,212870,211989,213195,209379,215012,210893,212455,214811,214004,208556,213567,200646,212142,202310,200624,200480,203281,200864,209474,213357,214055,214460,212842,209828,210221,215040,214939,214402,211643,211313,210171,208273,215099,214075,215027,215430,215280,215279,203802,214670,215492,212763,208547,201140,210536,200584,212689,208302,200677,200612,202738,215411,212524,215193,215696,212736,213424,205130,211782,201674,207183,214983,213598,209762,209671,215609,215629,207223,215175,212897,211876,215413,210839,213810,211490,210017,206231,213461,213468,215135,215137,214275,213203,211102,212169,211103,215235,215019,200596,207775,214908,214902,210037,205633,210556,212004,214946,204389,212060,214968,213353,215182,215412,201364,215530,214627,201712,206854,215192,215558,215008,215009,209402,208129,214990,214937,211804','','','2','','','',0
exec uspEvoliaGetContractDetailsForExtension_19092018 '','','','200747,203493,202813,200582,200752,200746,203111,200765,200739,200743,200708,201647,204232,200687,209746,200976,204223,212691,211678,212021,213372,208129,201712,206854,201364,211484,212018,201346,211658,206748,204238,200696,204228,212688,200721,200721,210400,200581,205851,200572,208264,200556,200496,200519,200759,212358,200735,200720,200660,204624,200571,211342,208780,210870,211961,212063,212925,201827,212078,201342,206670,208214,201090,212867,212681,212970,210697,213568,212817,210503,201678,210293,207442,212632,212288,213436,207943,205751,211771,212945,208862,211413,209696,213312,209433,210928,208006,211154,212678,213194,213637,213470,210415,205141,202485,206326,200509,213067,201780,211534,206583,213326,213117,207755,211355,211757,212424,212915,210081,212948,212282,205574,204186,208493,208861,211089,210582,212296,213588,213147,210174,204687,210362,212427,205446,210979,211638,205725,213488,207026,213143,211637,209920,213392,209592,209936,213442,213448,212081,209775,210651,213498,213645,213415,210548,211104,213305,209691,213501,213390,213423,210493,210852,212916,212844,212866,211958,211331,212941,210560,212289,207476,201500,201467,200500,213497,213499,200488,203425,213314,209190,211265,211261,209376,209463,212508,211254,211877,213052,213389,206059,201051,205338,213300,210004,212883,210053,213464,210358,212433,209655,207048,203600,210475,213068,213544,200493,208552,212501,212815,211285,201319,205695,209929,208062,212365,213116,213053,202866,206893,211655,212747,207966,211830,207471,203360,206029,203502,203361,212612,208809,213428,213419,211649,208808,212426,213181,201050,201034,200563,205402,200554,201935,200472,205841,200490,204963,213193,203877,213453,211521,208503,208508,210278,211948,212847,213146,208167,212889,210810,209575,212420,207528,212626,213142,206679,211284,208502,208063,200527,209584,210395,212877,212776,209671,205567,208694,207952,213080,212760,211778,212255,212366,200593,209117,213072,211849,213596,207935,212519,210489,212596,210403,211951,213408,203407,210378,213214,209387,213593,213176,209829,210173,206611,212002,211955,212499,211934,200483,208179,213368,210909,212264,212306,207089,206360,203663,206821,212057,210332,212260,211923,201933,210116,209403,203147,206771,212536,213013,213383,213269,205466,207396,210877,211426,212717,208317,209990,211919,211171,210731,213060,213358,209589,213271,211167,211056,200506,212287,212166,206763,203468,204910,208545,212345,208495,208311,209799,212502,213662,211990,212646,212713,201408,204227,208642,200879,212886,200663,210541,206467,204235,206210,203128,209689,212918,213635,210603,210740,205886,209591,206195,204260,206575,211893,204580,209581,206116,209688,211691,205924,206920,207547,204246,204243,204755,213467,209910,213179,211501,204233,212642,211897,207044,210145,204317,211500,212170,208256,204241,212938,205163,204240,207344,204244,213564,211350,207050,206035,212846,200719,212058,204247,201448,201763,200754,204334,211804,200607,200624,200612,200480,200864,200584,203807,212940,203294,209541,212434,208649,213313,207352,209630,213398,210287,209908,203409,204016,206021,208827,212019,213468,208302,208432,213203,212689,209828,213357,211551,210221,212842,203802,201140,204578,212528,213427,213120,208547,210536,212763,207823,211988,212524,212736,213489,213424,202738,200677,211782,208118,207223,201674,207183,212897,212899,209762,205130,213461,210017,208792,206231,211876,211490,210839,213144,210079,208030,207457,212971,211684,213048,210840,212959,203281,202310,207134,212004,210556,211103,212937,206919,212169,210037,200596,204389,207775,205633,211102,213353,212060,213330,211313,210171,211643,208273,207009,212585,208132,210308,212038,213548,212555,209960,212687,213630,202446,206187,204226,209355,204225,200685,201063,204230,207837,200698,201112,201752,211200,211563,209420,209425,204737,203666,211480,211346,209423,203621,207752,213175,210398,211535,211140,211537,209401,213586,211135,213582,213615,213204,203806,207758,211141,211366,201956,213178,212882,209386,209540,209418,210597,203756,213197,213198,209402,207756,211506,211482,211640,209391,213613,213070,213007,213074,209411,209395,211339,209315,211577,212957,213426,213614,211672,211508,210755,208469,201653,209419,211139,213073,213585,209424,211142,211505,212952,213174,203329,206589,200694,200678,201277,204248,211966,201284,209114,213445,209354,204237,200664,200674,204118,213177,200684,213161,205665,203236,212995,210466,206911,210328,207867,207045,200654,207291,207371,212984,210813,213646,207364,209470,204292,210589,210312,213664,204348,213534,204385,205870,210067,206950,211410,211622,204234,210311,210728,201934,203182,205724,204851,206915,206601,207843,208754,212275,209902,212470,207831,210363,208342,203296,213195,210893,209379,211235,211836,211989,212455,212870,212456,213393,213012,210137,213200,211663,212840,212862,212841,213570,212520,211774,213409,209877,207688,211821,211098,210638,212895,212927,213447,209585,204768,208556,200658,213567,200646,212142,200574,209090,213320,209733,209703,202773,210940,203842,203433,213130,206928','','','2','17/09/2018','23/09/2018','','1'

sp_helptext uspEvoliaGetContractDetailsForExtension_13092018
exec uspEvoliaGetDropdownDetails '','',''

SELECT * FROM VOTS_CONTRACT_EXTENSION_REQUEST WHERE ONE



--------------------------------------------------------------



exec uspEvoliaGetContractDetailsForExtension '','','','','','','2','','','010272181''010272094'


exec uspEvoliaGetContractDetailsForExtension_13092018 '','','','','','','2','17/09/2018','23/09/2018','010272094',1
exec uspEvoliaGetContractDetailsForExtension_13092018 '','','','','','','2','17/09/2018','23/09/2018','',0


select * from VOTSConsultant
select * from INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE 'VOTS%'

select * from INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='VOTS_CONTRACT_EXTENSION_REQUEST'
SELECT DATABASEPROPERTYEX('VOTS_CONTRACT_EXTENSION_ACTION_TYPE','COLLATION')

SELECT * FROM VOTS_CONTRACT_EXTENSION_REASON
SELECT * FROM VOTS_CONTRACT_EXTENSION_REQUEST WHERE MISS_CODE='010272181'
SELECT * FROM VOTS_CONTRACT_EXTENSION_ACTION_TYPE


select VER.* from VOTS_CONTRACT_EXTENSION_REQUEST VER inner join VOTS_CONTRACT_EXTENSION_ACTION_TYPE VA on VER.ACTION_TYPE=VA.ACTION_ID where VER.ACTION_TYPE=2



Add column in request tbl.

alter table 



27092018----------------------------------------
CREATE TABLE select * from temp_tblContractInfo  
            (  
              ID INT IDENTITY(1, 1),  
              ctUserId INT,  
              ctContractId INT,  
              ctClientId INT,  
              ctMissCode VARCHAR(13),  
              ctMissJustification VARCHAR(255),  
              ctcontractStartDate DATETIME,  
              ctcontractEndDate DATETIME,
              ctMonthlyWeeklyFlag INT, --added in sprint 23
			  ctCnti_ordre INT -- added in sprint27
            )      
            
            ALTER TABLE temp_tblContractInfo ADD MODIFIEDDATE DATETIME
               
CREATE TABLE temp_logger    
(
	ID INT IDENTITY(1,1) PRIMARY KEY,
	USERLOG varchar(max),
	MODIFIEDDATE DATETIME
)

SELECT * FROM temp_logger
DECLARE @UserID INT 
DECLARE @contractID INT 
DECLARE @contractEndDate DATETIME 
DECLARE @ctCnti_ordre INT
SET @ctCnti_ordre=43
SET @contractEndDate='2018-09-26 14:00:00:000'
SET @UserID=12312
SET @contractID=32132
INSERT INTO temp_logger(MODIFIEDDATE,USERLOG) VALUES(GETDATE(),'SELECT * FROM VOTSContractDetails WHERE   UserId = '''+ convert(varchar,@UserID  )
                                +''' AND ContractId = '''+ convert(varchar,@contractID  )
                                +''' AND (Contract_End_Date <> '''+ convert(datetime,@contractEndDate)+''' OR ModifiedBy <> -3 OR CNTI_ORDRE <> '''+Convert(varchar,@ctCnti_ordre)+''' )')
                                
                                
                                
                                
                                
                                SELECT * FROM VOTSContractDetails WHERE   UserId = '67114' AND ContractId = '252692' AND (Contract_End_Date <> 'Sep 26 2018  2:00PM' OR ModifiedBy <> -3 OR CNTI_ORDRE <> '43' )
                                DECLARE @contractID INT
                                SET @contractID=32132
                                select 'recode updated with C and contractid:' + convert(varchar,@contractID)
                                
                                
                          select 'recode updated  and contractid:' + convert(varchar,VOTSContractDetails.ContractId)
                          
                          select * from VOTSContractDetails
 inner join (SELECT DISTINCT C.CNT_ID, C.CNT_DATEFIN, CO.Contract_End_Date
					   FROM [FRRDBCEG05\CEGI].[SCHHAYS].dbo.PYCONTRAT C
					   LEFT JOIN [FRRDBCEG05\CEGI].[SCHHAYS].dbo.[WTMISSTIEIWEB] WB ON C.CNT_ID=WB.CNT_ID
					   INNER JOIN [FRRDBCEG05\CEGI].[SCHHAYS].dbo.[WTTIEINT] WT ON WT.[TIE_ID] = WB.[TIE_ID] AND WT.[TIEI_ORDRE] = WB.[TIEI_ORDRE] AND WT.TIEI_RVI= 1 
					   INNER JOIN VOTSContractDetails CO ON CO.ContractID = C.CNT_ID
					WHERE 
						C.CNT_DATEFIN <> CO.Contract_End_Date --AND CNT_DATEFIN >= GETDATE() - 30   
						)CL
						on CL..Contract_End_Date
						                     
						                     
						                     select top 10 * from JobStatus order by 1 desc


-----------------------------------------------------------
SELECT DISTINCT C.CNT_ID, C.CNT_DATEFIN, CO.Contract_End_Date  
        FROM [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].PYCONTRAT C  
        LEFT JOIN [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].[WTMISSTIEIWEB] WB ON C.CNT_ID=WB.CNT_ID  
        INNER JOIN [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].[WTTIEINT] WT ON WT.[TIE_ID] = WB.[TIE_ID] AND WT.[TIEI_ORDRE] = WB.[TIEI_ORDRE] AND WT.TIEI_RVI= 1   
        LEFT JOIN VOTSContractDetails CO ON CO.ContractID = C.CNT_ID  
     WHERE   
      C.CNT_DATEFIN <> CO.Contract_End_Date   AND CNT_DATEFIN >= GETDATE() - 1
      
      

select * from VOTSContractDetails where ContractId=252692--254884252692   254884
--select * from VOTSTime where ContractId=252692   
select * from VOTS_TimesheetStatus where TimeId in (select TimeId from VOTSTime where ContractId=252692 and Month=9 and Year=2018)
select * from [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].PYCONTRAT where CNT_ID=254884252692
select * from [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].[WTMISSTIEIWEB] where CNT_ID=252692
select * from [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].[WTMISS] where CNT_ID=254884--252692
      
sp_helptext uspVOTSRegularDataCopy
select * from [FRRDBCEG05\CEGI].[SCHHAYS].[dbo].[WTMISS] where MISS_MODIFDATE>='2018-09-26 09:10:51.673'
select GETDATE()       
      
SELECT * FROM VOTS_TimesheetStatus WHERE timeid in ( SELECT TimeId FROM VOTSTime WHERE ContractId=252692 AND UserId= 67114 ) 
          
       AND TSStatus='C' AND (StartOfWeek not BETWEEN '2018-04-10 00:00:00.000' AND '2018-09-15 00:00:00.000' OR EndOfWeek not BETWEEN '2018-04-10 00:00:00.000' 
       AND '2018-09-15 00:00:00.000') 
       

                SELECT   * 
                FROM    VOTSTime WITH ( NOLOCK )    
                WHERE   UserId = 67114    
                        AND ContractId = 252692        

declare @b int
if exists (SELECT * FROM VOTSContractDetails WHERE   UserId = 67114    
                                AND ContractId = 252692
                                AND (Contract_End_Date <> '2018-09-15 00:00:00.000' OR ModifiedBy <> -3 OR CNTI_ORDRE <> 3 )  )
                                begin
                                
                                select @b=COUNT(*) from VOTSTime
                                
                                end   
                                select @b   
 
 select * from VOTSUser where EvoliaId=67114
 select * from VOTSContractDetails where ContractId=252692   --2018-09-15 00:00:00.000
 
 BEGIN TRAN
 UPDATE VOTSContractDetails SET Contract_End_Date='2018-09-18 00:00:00.000' where ContractId=252692
 ROLLBACK TRAN
 COMMIT TRAN
 
 BEGIN TRAN
 UPDATE VOTS_TimesheetStatus SET TSStatus='C' WHERE TSStatus='I' AND StatusId IN (242667,242668)
 COMMIT TRAN


-**********************************************************************************************************-------------------